<!DOCTYPE html>
<html>
<head>
    <title>Redirigiendo...</title>
    <meta charset="utf-8" />
    <script>
        // short > url map
        const urlMap = {
            'n': 'https://github.com/clarius/normas/blob/main/'
        };

        function redirectMapped() {
            const params = new URLSearchParams(window.location.search);
            const hash = window.location.hash;
            let redirected = false;

            for (const paramKey in urlMap) {
                if (params.has(paramKey)) {
                    let path = params.get(paramKey);
                    const baseUrl = urlMap[paramKey];

                    if (path) {
                        // Check if the path segment after the last '/' contains a '.'
                        // If not, assume it's a directory or extensionless file and append .md
                        const parts = path.split('/');
                        const lastPart = parts[parts.length - 1];
                        if (lastPart && !lastPart.includes('.')) {
                            path += '.md';
                        }

                        const targetUrl = `${baseUrl}${path}${hash}`;
                        window.location.replace(targetUrl);
                        redirected = true;
                        break;
                    } else {
                        // Redirect to base URL if the parameter is empty
                        console.error(`El parámetro '${paramKey}' no tiene valor.`);
                        const repoBaseUrl = baseUrl.substring(0, baseUrl.indexOf('/blob/'));
                        window.location.replace(`${repoBaseUrl}`);
                        redirected = true;
                        break;
                    }
                }
            }

            if (!redirected) {
                console.error("No se encontró un parámetro de redirección válido.");
                window.location.replace(`https://github.com/clarius`);
            }
        }

        window.onload = redirectMapped;
    </script>
</head>
<body>
    <p>Si no eres redirigido automáticamente, algo salió mal.</p>
</body>
</html>